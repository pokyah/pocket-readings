<html>
	<head>
		<title>Pocket Reads</title>
    <meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">

		<script defer src="https://code.getmdl.io/1.3.0/material.min.js"></script>
		<script type="text/javascript" src="js/ICanHaz.js"></script>
		<script type="text/javascript" src='js/jquery.js '></script>
    <script type="text/javascript" src='js/tabletop.js'></script>
    <script type="text/javascript" src='js/site.js'></script>
		<script type="text/javascript" src='js/sheetsee.js'></script>

    <!--
		<script src="https://code.jquery.com/jquery-3.1.1.slim.min.js" integrity="sha384-A7FZj7v+d/sdmMqp/nOQwliLvUsJfDHW+k9Omg/a/EheAdgtzNs3hpfag6Ed950n" crossorigin="anonymous"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.4.0/js/tether.min.js" integrity="sha384-DztdAPBWPRXSA/3eYEEUWrWCy7G5KFbe8fFjk5JAIxUYHKkDx6Qin1DkWx51bBrb" crossorigin="anonymous"></script>
		<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/js/bootstrap.min.js" integrity="sha384-vBWWzlZJ8ea9aCX4pEW3rVHjgjt7zpkNpZk+02D9phzyeVkE+jo0ieGizqPLForn" crossorigin="anonymous"></script>

		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.min.css" integrity="sha384-rwoIResjU2yc3z8GV/NPeZWAv56rSmLldC3R/AZzGRnGxQQKnKkoFVhFQhNUwEyJ" crossorigin="anonymous">
     !-->

		<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
		<link rel="stylesheet" href="https://code.getmdl.io/1.3.0/material.teal-deep_orange.min.css" />

		<link media="screen" rel="stylesheet" type="text/css" href="css/style.css">
</head>

<body>
	<div id="MDLwrapper">
		<!-- Always shows a header, even in smaller screens. -->
		<div class="mdl-layout mdl-js-layout mdl-layout--fixed-header">
		  <header class="mdl-layout__header">
		    <div class="mdl-layout__header-row">
		      <!-- Title -->
		      <span class="mdl-layout-title"><div id="title"></div></span>
		      <!-- Add spacer, to align navigation to the right -->
		      <div class="mdl-layout-spacer"></div>


					<!-- Add spacer, to align navigation to the right -->
		      <div class="mdl-layout-spacer"></div>
		      <!-- Navigation. We hide it in small screens. -->
		      <nav class="mdl-navigation mdl-layout--large-screen-only">

					<i class="material-icons">search</i>
						<form action="#">
							<div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
								<input id="articleSearch" class="mdl-textfield__input" type="text">
								<label class="mdl-textfield__label" for="sample3">Search for...</label>
							</div>
						</form>


		        <a class="mdl-navigation__link" href="#info">About</a>
		        <a class="mdl-navigation__link" href="https://about.me/pokyah/">Pokyah</a>
						<span id="selectedCounter" class="material-icons mdl-badge mdl-badge--overlap" data-badge="0">folder_special</span>
						<a class="mdl-navigation__link" href=""><i class="material-icons">share</i></a>
						<!-- Left aligned menu below button -->



		      </nav>
		    </div>
		  </header>
		  <div class="mdl-layout__drawer">
		    <span class="mdl-layout-title">Title</span>
		    <nav class="mdl-navigation">
		      <a class="mdl-navigation__link" href="">About</a>
		      <a class="mdl-navigation__link" href="">Pokyah</a>

		    </nav>
		  </div>
		  <main class="mdl-layout__content">
		    <div class="page-content">

					<div id="filters" class="container">

						<h3>Tags</h3>
						<span id="tags"></span>
					</div>
					<div id="articleTable"></div>
				</div>

				<!-- Wide card with -->
				<div style="width:100%" id="info" class="demo-card-wide mdl-card mdl-shadow--2dp">
				  <div class="mdl-card__title">
				    <h2 class="mdl-card__title-text">ABOUT</h2>
				  </div>
				  <div class="mdl-card__supporting-text">
						<p>This is an open source, easy to replicate project by <a href="http://www.twitter.com/jllord" target="_blank">@jllord and adapted by @pokyah</a>. If you use <a href="http://www.getpocket.com" target="_blank">Pocket</a> to save articles for later, you can also use <a href="http://www.ifttt.com" target="_blank">ifttt.com</a> (if this than that) to automate sending the article details to a Google Spreadsheet once you've archived it. Once you have a Google Spreadsheet you can use <a href="http://jlord.github.io/sheetsee.js" target="_blank">sheetsee.js</a> to turn into a website like so. So many possibilities! See the <a href="http://www.github.com/jlord/sheetsee-pocket#hi" target="_blank">documentation</a> to learn how to set up your own or contribute code!</p>
				  </div>
				  <div class="mdl-card__actions mdl-card--border">
				    <a class="mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect">
				      Get Started
				    </a>
				  </div>
				  <div class="mdl-card__menu">
				    <button class="mdl-button mdl-button--icon mdl-js-button mdl-js-ripple-effect">
				      <i class="material-icons">share</i>
				    </button>
				  </div>
				</div>


		  </main>
		</div>
	</div>


	<script id="title" type="text/html">
		<a>{{numArticles}} </a>
		<span>articles from <a href="https://getpocket.com/a/queue/" class="tag mdl-chip__text">Pocket</a></span>
	</script>

  <script id="tags" type="text/html">
    {{#rows}}
		<span href="#" class="tag mdl-chip">
			<span class="mdl-chip__text">{{.}}</span>
		</span>
    {{/rows}}
  </script>

	<script id="articleTable" type="text/html">
	<ul class="demo-list-control mdl-list">
	{{#rows}}
	<li id="{{rowNumber}}" class="mdl-list__item mdl-list__item--three-line">
		<span class="mdl-list__item-primary-content">
			<i class="material-icons mdl-list__item-avatar">person</i>
			<span><a href="{{url}}" target="_blank">{{article}}</a></span><span> (added : {{date}})</span>
			<span class="mdl-list__item-text-body">
				{{excerpt}}
				<span class="mdl-list__item-sub-title">
				{{#tags}}
					<a class="item-tags">{{tag}}, </a>
				{{/tags}}
				</span>
			</span>
		</span>
		<span class="mdl-list__item-secondary-content">
			<p>ref : {{rowNumber}}</p>
			<a class="mdl-list__item-secondary-action" href="#"><i class="material-icons">star</i></a>
		</span>
	</li>
	{{/rows}}
	</ul>
</script>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    var URL = "1h4FaVnt3EyoA4_WYPiokEBdwDBcszInIudsreNL27Yk"
    Tabletop.init( { key: URL, callback: showInfo, simpleSheet: true } )
  })

  function showInfo(data) {
    var gData = separateTags(data)
    drawTags(gData)
    cleanDates(gData)
    pageTitle(gData)
    Sheetsee.makeTable(gData.reverse(), "#articleTable")
    Sheetsee.initiateTableFilter(gData, "#articleSearch", "#articleTable")

		var count = 0;
		var url = window.location.href
		var query = url.substring(url.indexOf('q?')+1)
		var queryArray = []

		if(query !== ""){
			queryArray.push(query)
			queryFilter = getTagMatches(gData, queryArray)
			Sheetsee.makeTable(queryFilter.reverse(), "#articleTable");
		}

		/*$("#articleTable .element").on("click" , function(event){
			var newElement = $(event.target);
			newElement = newElement.parents(".element");

			if(newElement.hasClass("hovered")){
				newElement.removeClass("hovered")
			}
			else{
				newElement.addClass("hovered")
			}
		})*/

    $(document).on("click", ".tag" , function(event){
      var newTag = $(event.target);

			if(newTag.hasClass("hovered")){
				newTag.removeClass("hovered")
			}
			else{
				newTag.addClass("hovered")
			}

			var tags = $(".hovered");
			var textTags = [];

			tags.each(function(i) {
			  textTags.push($( this ).text() );
			});

			var tagFilter = getTagMatches(gData, textTags)
      Sheetsee.makeTable(tagFilter.reverse(), "#articleTable")
    })

		$(document).on("click", "li" , function(event){

			var newItem = $(event.target);
			var li = $(newItem).closest("li");
			if(li.hasClass("selected")){
				li.removeClass("selected")
				count = count - 1;
				$('#selectedCounter').attr('data-badge', count.toString())
			}
			else{
				li.addClass("selected")
				count = count + 1;
				$('#selectedCounter').attr('data-badge', count.toString())
			}

			var lis = $(".selected");
			var liElements = [];

			lis.each(function(i) {
				liElements.push($( this ).attr('id') );
			});

			var queryUrl = liElements.join("&")
			window.location.hash=queryUrl;

		})
  }
</script>

</body>
</html>
